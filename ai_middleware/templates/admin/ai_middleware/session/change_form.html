{% extends 'admin/change_form.html' %}
{% load static %}

{% block extrahead %}
{{ block.super }}
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
<link rel="stylesheet" href="{% static 'ai_middleware/admin/css/custom_admin.css' %}">
{% endblock %}

{% block content %}
{{ block.super }}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Configuration de l'éditeur riche pour les champs texte
    const textFields = ['context', 'objectives', 'inputs', 'outputs', 
                       'participants', 'design_principles', 'deliverables'];
    
    textFields.forEach(field => {
      const textarea = document.getElementById('id_' + field);
      if (textarea) {
        const container = document.createElement('div');
        container.innerHTML = textarea.value;
        textarea.parentNode.insertBefore(container, textarea);
        textarea.style.display = 'none';
        
        const quill = new Quill(container, {
          theme: 'snow',
          modules: {
            toolbar: [
              [{ 'header': [1, 2, 3, false] }],
              ['bold', 'italic', 'underline'],
              [{ 'list': 'ordered'}, { 'list': 'bullet' }],
              ['link', 'image'],
              ['clean']
            ]
          }
        });
        
        // Mise à jour du textarea avant soumission
        const form = textarea.form;
        form.addEventListener('submit', function() {
          textarea.value = quill.root.innerHTML;
        });
      }
    });
  });
</script>
{% endblock %}